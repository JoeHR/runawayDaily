# javascript 中执行上下文和执行栈是什么？

## 执行上下文

> 简单来说，执行上下文就是一种对 `javascript`代码执行环境(当前执行环境中的变量、函数声明、参数（arguments）、作用域链、this等信息)的抽象概念，也就是说只要有 `javascript` 代码运行，那么它就一定是在运行在执行上下文中。执行上下文定义了变量或函数有权访问的其它数据，据定了它们各自的行为。每个执行环境（执行上下文）都有一个与之关联的变量对象，上下文中顶一的所有变量和函数都保存在这个对象中。虽然我们编写的代码无法访问这个对象，但解析器在处理数据时会在后台使用它。

执行上下文的分类

- 全局执行上下文：只有一个，浏览器中的全局对象就是 `window` 对象, `this` 就指向这个全局对象，也是最外围的一个执行上下文
- 函数执行上下文：存在无数个，只有在函数被调用的时候才会被创建，每次调用函数都会创建一个新的执行上下文
- Eval 函数执行上下文： 指的是运行在 `eval` 函数中的代码，很少用而且不建议用

某个执行上下文中的所有代码执行完毕后，该环境被销毁，保存在其中的所有变量和函数顶一也随之销毁（但web浏览器中的全局上下文是直到应用程序退出--例如关闭网页或浏览器--时才会被销毁）

**只有全局上下文(的变量)能被其他任何上下文访问**


执行上下文的生命周期：创建阶段 -> 执行阶段 -> 回收阶段


创建阶段(当函数被调用，但未执行任何其内部代码之前)主要做了三个事情：

- 确定`this`的值，也被称为 绑定this(This Binding)
- lexicakEnvironment(词法环境)组件被创建
- VariableEnvironment(变量环境)组件被创建

## 执行栈

> 也叫调用栈，具有LIFO(后进先出)结构，用于存储在代码执行期间创建的所有执行上下文

首次运行JS代码时，会创建一个全局执行上下文并 push 到执行上下文栈顶中，然后随着每次函数的调用都会创建一个新的执行上下文放入到栈顶中，随着函数执行完毕后被执行上下文栈顶弹出，知道回到全局执行上下文中。





